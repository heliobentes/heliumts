# HeliumTS Pentest Runner

This repository includes a safe, non-destructive pentest script you can run against your HeliumTS app deployments.

## What it checks

- Sensitive file exposure (`/.env`, `/.git/config`, `helium.config.*`, etc.)
- Refresh token endpoint hardening:
  - `GET /__helium__/refresh-token` should be blocked (`405`)
  - `POST` without `X-Requested-With` should be blocked (`403`)
- RPC endpoint hardening:
  - `POST /__helium__/rpc` without token should be rejected (`401`)
  - Invalid token should be rejected (`401`)
  - Oversized body should be rejected (`413`)
- Basic client bundle scan for secret-like indicators

## Run

```bash
node scripts/helium-pentest.mjs --url http://localhost:3000
```

For staging/production:

```bash
node scripts/helium-pentest.mjs --url https://staging.example.com --timeout 12000 --max-js 12
```

## Exit codes

- `0`: no high/medium findings
- `1`: one or more high/medium findings

## Notes

- This is a security smoke test, not a full penetration test.
- Run only against systems you own or are explicitly authorized to test.
- Pair with manual review of auth logic, authorization checks, and business-critical endpoints.
